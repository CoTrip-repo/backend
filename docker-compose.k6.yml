# K6 부하 테스트 실행용 Docker Compose
# Step 1: AI Fallback 성능 테스트
version: '3.8'

services:
  k6:
    image: grafana/k6:latest
    container_name: k6-ai-fallback-test
    networks:
      - monitoring
    volumes:
      - ./k6-step1-ai-fallback.js:/scripts/k6-step1-ai-fallback.js
    environment:
      - K6_OUT=influxdb=http://influxdb:8086/k6
      - BASE_URL=http://host.docker.internal:8080
      - VUS=50
    extra_hosts:
      - "host.docker.internal:host-gateway"
    command: run --out influxdb=http://influxdb:8086/k6 /scripts/k6-step1-ai-fallback.js
    depends_on:
      - influxdb

networks:
  monitoring:
    external: true
    name: backend_monitoring
